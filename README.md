<img width="320" height="320" alt="face" src= "https://github.com/user-attachments/assets/74e8b490-f7d8-40c3-afae-51649b9db19f" /> face


<img width="320" height="320" alt="face_grayscale" src= "https://github.com/user-attachments/assets/74cbf940-3309-412c-8a0b-914e0be30884" /> face_grayscale

<img width="320" height="320" alt="face_output_edge" src= "https://github.com/user-attachments/assets/fde03702-21f6-4822-ba26-6583a727a40f" /> face_output_edge

## 문서 관리 정보
- 문서 ID: BMP-DO178C-001
- 버전/ 날짜: 1.1 / 2025년 9월 8일
- 분류: 설계 보증 레벨 D (DAL-D)
- 시스템: 휴대폰 안면 인식 장치
- 업데이트 내용: Sobel 필터링 기능 상세화

## 소프트웨어 요구사항 표준 (SRS)

### 1. 상위레벨 요구사항
**HLR-001**: 이미지 형식 검증
- 소프트웨어는 입력 파일이 24비트 BMP 형식임을 검증해야 한다
- 소프트웨어는 이미지 크기가 630x630 픽셀임을 확인해야 한다
- 소프트웨어는 유효하지 않은 파일 형식을 적절한 오류 메시지와 함께 거부해야 한다

**HLR-002**: 색공간 변환
- 소프트웨어는 표준 휘도 공식을 사용하여 RGB 픽셀을 그레이스케일로 변환해야 한다: $Y = 0.299R + 0.587G+ 0.114*B$
- 변환 과정에서 픽셀의 공간적 관계를 유지해야 한다
- 출력 값은 0-255 범위 내에 있어야 한다
  
**HLR-003**: 출력 파일 생성
- 소프트웨어는 8비트 그레이스케일 BMP 파일을 생성해야 한다
- 소프트웨어는 256색 그레이스케일 팔레트를 포함해야 한다
- 출력 BMP 파일은 BMP 표준을 준수해야 한다
- 출력 mem 파일은 16진수(아스키코드)를 한 줄씩 나열한 형식이어야 한다
  
**HLR-004**: 메모리 관리
- 소프트웨어는 동적 메모리 할당 실패를 감지하고 처리해야 한다
- 소프트웨어는 할당된 모든 메모리를 적절히 해제해야 한다
- 메모리 누수가 발생하지 않아야 한다
  
**HLR-005**: 오류 처리
- 소프트웨어는 파일 입출력 오류를 감지하고 보고해야 한다
- 소프트웨어는 비정상 종료 시 리소스를 정리해야 한다
- 모든 오류 상황에 대해 명확한 메시지를 제공해야 한다

**HLR-006**: mem파일 변환
- mem 파일은 시뮬레이션용으로 주소별 데이터(16진수)를 한 줄씩 나열한 형식이어야 한다
- 변환 과정에서 그레이스케일 BMP 데이터를 아스키코드로 변환하여 저장해야 한다

**HLR-007**: sobel 필터링
- 소프트웨어는 3x3 Sobel 연산자를 사용하여 엣지 검출을 수행해야 한다
- 수평 방향 Sobel 커널 (Gx): [[-1,0,1],[-2,0,2],[-1,0,1]]
- 수직 방향 Sobel 커널 (Gy): [[-1,-2,-1],[0,0,0],[1,2,1]]
- 엣지 강도는 $|sqrt{Gx^2 + Gy^2}|$ 공식을 사용하여 계산해야 한다
- 경계 픽셀 처리를 위한 안전한 인덱싱을 구현해야 한다
- 결과를 8비트 그레이 스케일 BMP 파일로 저장해야한다


### 2. 저수준 요구사항
**LLR-001**: BMP 헤더 검증
- 파일 시그니처가 0x4D42 ("BM")인지 확인
- bitCount 필드가 24인지 검증
- width와 height가 각각 630인지 확인

**LLR-002**: 픽셀 데이터 읽기
- BMP 픽셀 데이터를 하단부터 상단 순으로 읽기
- 각 행의 패딩 바이트 처리
- RGB 구조체로 픽셀 데이터 저장

**LLR-003**: 그레이스케일 변환 알고리즘
- 각 픽셀에 대해 $Y = 0.299R + 0.587G + 0.114*B$ 공식 적용
- 결과를 uint8_t 형으로 캐스팅
- 변환된 값을 별도 배열에 저장

**LLR-004**: 출력 그레이스케일 BMP 생성
- 8비트 BMP용 헤더 구조 생성
- 256색 그레이스케일 팔레트 작성
- 그레이스케일 데이터를 하단부터 상단 순으로 출력

**LLR-005**: mem 변환 알고리즘
- 그레이스케일 픽셀에 대해 16진수로(%02X) 변환
- 각 픽셀 값을 줄바꿈(0x0D 0x0A)으로 구분

**LLR-006**: sobel 필터링 알고리즘
- Sobel X 필터 배열: sobelX[3][3] = {{-1,0,1}, {-2,0,2}, {-1,0,1}}
- Sobel Y 필터 배열: sobelY[3][3] = {{-1,-2,-1}, {0,0,0}, {1,2,1}}
- 각 픽셀 (x,y)에 대해 3x3 영역의 컨볼루션 수행
- Gx = Σ(pixel * sobelX[i][j]) for i,j in [-1,0,1]
- Gy = Σ(pixel * sobelY[i][j]) for i,j in [-1,0,1]
- 엣지 강도 = $sqrt(Gx² + Gy²)$

**LLR-007**: 경계 처리 알고리즘
- getPixel() 함수를 통한 안전한 픽셀 액세스
- 이미지 경계 밖 좌표의 경우 가장 가까운 유효 픽셀로 클램핑
- x < 0인 경우: x = 0
- x >= width인 경우: x = width - 1
- y < 0인 경우: y = 0
- y >= height인 경우: y = height - 1


**LLR-008**: 출력 Sobel BMP 생성
- 8비트 BMP용 헤더 구조 생성 (그레이스케일과 동일한 구조)
- 256색 그레이스케일 팔레트 작성
- 엣지 데이터를 하단부터 상단 순으로 출력
- BMP 행 패딩 처리

## 소프트웨어 설계 표준 (SDS)
### 1. 아키텍처 설계
**모듈구조:**
```
face_GraytoSobel
├──── result
│ ├──── face_grayscale.bmp
│ ├──── face_output_edge.bmp
│ └──── face_output_image.mem
├──── x64/Debug
│ ├──── face_Gra.97075ee7.tlog
│ │ ├──── face_Gray_to_Sobel.exe.recipe
│ │ ├──── face_Gray_to_Sobel.ilk
│ │ ├──── face_Gray_to_Sobel.log
│ │ ├──── face_Gray_to_Sobel.obj
│ │ ├──── vc143.idb
│ │ └──── vc143.pdb
│ ├──── face.bmp
│ ├──── face_Gray_to_Sobel.c
│ ├──── face_Gray_to_Sobel.vcxproj
│ ├──── face_Gray_to_Sobel.vcxproj.filters
│ └──── face_Gray_to_Sobel.vcxproj.user
└──── README.md
```
**데이터 흐름:**
1. BMP 파일 읽기 → RGB 데이터 추출
2. RGB → 그레이스케일 변환
3. 그레이스케일 → Sobel 필터링
4. 출력 파일 생성 (그레이스케일 BMP, Sobel BMP, MEM)

### 2. 상세 설계
**구조체 정의:**
- BMPFileHeader: BMP 파일 헤더 정보
- BMPInfoHeader: BMP 정보 헤더
- RGB: 24비트 RGB 픽셀 데이터

**주요 함수 (Sobel 관련 업데이트):**
- main(): 메인 프로세스 제어
- rgbToGrayscale(): RGB-그레이스케일 변환
- **findEdges()**: Sobel 필터 적용 및 엣지 검출
  - 입력: 그레이스케일 이미지 배열
  - 출력: 엣지 검출 결과 배열
  - 처리: 각 픽셀에 대해 3x3 Sobel 컨볼루션 수행
- **getPixel()**: 안전한 픽셀 액세스 함수
  - 경계 조건 처리
  - 유효 범위 내 픽셀 값 반환
- 파일 I/O 처리 루틴
- 메모리 할당/해제 루틴

**Sobel 필터링 프로세스:**
1. 그레이스케일 이미지를 입력으로 받음
2. 각 픽셀을 중심으로 3x3 윈도우 설정
3. X방향, Y방향 Sobel 커널과 컨볼루션 수행
4. 그래디언트 크기 계산: $\sqrt{Gx^2 + Gy^2}$
5. 255를 초과하는 값 클램핑
6. 결과를 출력 배열에 저장

### 3. 인터페이스 설계
**입력 인터페이스:**
- **파일명: ```"face.bmp"```**
- 형식: 24비트 컬러 BMP
- 크기: 630*630 픽셀

**출력 인터페이스:**
- **파일명: ```"face_grayscale.bmp"```**
  - 형식: 8비트 그레이스케일 BMP
  - 팔레트: 256색 그레이스케일

- **파일명: ```"face_output_edge.bmp"```**
  - 형식: 8비트 Sobel 필터링 적용 BMP
  - 내용: 엣지 강도를 그레이스케일로 표현
  - 특성: 밝은 영역은 강한 엣지, 어두운 영역은 약한 엣지

- **파일명: ```"face_output_image.mem"```**
  - 형식: 16진수 텍스트 파일
  - 내용: 그레이스케일 픽셀 값을 2자리 16진수로 표현

## 소프트웨어 코드 표준 (SCS)
### 1. 코딩 규칙
**명명 규칙:**
- 구조체: PascalCase (예: BMPFileHeader)
- 함수: camelCase (예: rgbToGrayscale, findEdges, getPixel)
- 변수: camelCase (예: imageData, edgeData, grayscaleData)
- 상수: UPPER_CASE (예: IMAGE_WIDTH, IMAGE_HEIGHT)
- 배열: 의미있는 이름 (예: sobelX, sobelY)

**Sobel 관련 코딩 표준:**
- 필터 커널은 정적 전역 배열로 정의
- 경계 처리 함수는 인라인 최적화 가능하도록 구현
- 수학 연산은 정수 오버플로우 방지 고려

### 2. 품질 기준
**가독성:**
- Sobel 필터링 알고리즘에 대한 상세 주석
- 수학적 공식에 대한 설명 포함
- 변수명으로 의도 명확화 (gx, gy, edge 등)

**성능:**
- 불필요한 함수 호출 최소화
- 메모리 액세스 패턴 최적화
- sqrt() 함수 사용 시 성능 고려
  

## 소프트웨어 검증 계획 (SVP)
### 1. 검증 목표
- 모든 요구사항이 올바르게 구현되었는지 확인
- Sobel 필터링의 수학적 정확성 검증
- 경계 조건에서의 소프트웨어 동작 검사

### 2. 검증 방법
**정적 분석:**
- 코드 리뷰 (특히 Sobel 알고리즘 검토)
- 수학적 공식 검증

**동적 테스트:**
- 단위 테스트 (getPixel, findEdges 함수)
- 통합 테스트
- 성능 테스트

### 3. 테스트 케이스
**TC-001: 정상 입력 처리**
- 유효한 630*630 24비트 BMP 파일 입력
- 예상 결과: 성공적인 그레이 스케일 BMP 파일 & mem파일 변환 및 출력  

**TC-002: 잘못된 파일 형식**
- 비 BMP 파일 입력
- 예상 결과: 오류 메세지 출력 및 프로그램 종료

**TC-003: 잘못된 이미지 크기**
- 630*630이 아닌 BMP 파일 입력
- 예상 결과: 크기 오류 메세지 출력

**TC-004: 메모리 부족 상황**
- 메모리 할당 실패 시뮬레이션 예상 결과:  적절한 오류 처리 및 리소스 정리

**TC-005: 파일 I/O 오류** 
- 읽기/쓰기 권한 없는 파일 처리
- 예상 결과: I/O 오류 메세지 출력

**TC-006: Sobel 필터링 정확성 테스트 **
- 알려진 패턴의 이미지로 Sobel 필터링 수행
- 예상 결과: 수학적으로 정확한 엣지 검출 결과
- 검증 방법: 수동 계산 결과와 비교

**TC-007: 경계 픽셀 처리 테스트 **
- 이미지 경계 근처의 픽셀들에 대한 Sobel 필터링
- 예상 결과: 경계 밖 접근 없이 안전한 처리
- 검증 항목: 메모리 액세스 위반 없음

**TC-008: 극값 테스트 **
- 모든 픽셀이 0 또는 255인 이미지
- 예상 결과: 오버플로우 없이 정상 처리

**TC-009: 성능 테스트 **
- 630×630 이미지의 Sobel 필터링 처리 시간 측정
- 예상 결과: 허용 가능한 처리 시간 내 완료

**TC-010: 출력 파일 무결성 테스트 **
- 생성된 Sobel BMP 파일의 구조적 유효성 검사
- 예상 결과: BMP 표준 준수 및 올바른 팔레트 생성

### 4. 검증 기준

**기능적 정확성:**
- Sobel 필터링 결과가 수학적 공식과 일치
- 엣지 검출이 시각적으로 예상되는 결과와 부합
- 모든 출력 파일이 올바른 형식으로 생성

**신뢰성:**
- 다양한 입력 이미지에 대해 일관된 결과
- 메모리 누수 없음
- 예외 상황에서 안전한 종료

**성능:**
- 630×630 이미지 처리가 합리적 시간 내 완료
- 메모리 사용량이 허용 범위 내

### 5.4 커버리지 기준

**구문 커버리지 (Statement Coverage):**
- 모든 실행 가능한 코드 라인이 최소 1회 실행되어야 함
- 목표: 100% 구문 커버리지

**분기 커버리지 (Branch Coverage):**
- 모든 조건문의 참/거짓 경로가 실행되어야 함
- 목표: 100% 분기 커버리지

**조건 커버리지 (Condition Coverage):**
- 복합 조건문의 각 개별 조건이 참/거짓으로 평가되어야 함
- 목표: 100% 조건 커버리지

**기능 커버리지 (Functional Coverage):**
- 모든 요구사항이 테스트 케이스로 검증되어야 함
- 추적성 매트릭스를 통한 요구사항-테스트 매핑 확인

## 6. 소프트웨어 형상관리 계획 (SCMP)

### 6.1 형상관리 목표
- 소프트웨어 생명주기 동안 모든 변경사항 추적
- 베이스라인 관리 및 버전 제어
- 변경 이력의 완전성 및 무결성 보장
- 릴리스 관리 및 배포 제어

### 6.2 형상 식별

**소스 코드 파일:**
- face_Gray_to_Sobel.c (버전 제어 대상)
- 컴파일러 설정 파일
- 프로젝트 파일 (.vcxproj, .vcxproj.filters)

**실행 파일:**
- face_Gray_to_Sobel.exe
- 관련 라이브러리 파일

**문서화 자료:**
- DO178C 인증 문서 (SRS, SDS, SCS, SVP, SCMP)
- 사용자 매뉴얼
- 기술 문서

**테스트 케이스 및 결과:**
- 테스트 시나리오 파일
- 테스트 데이터 (입력 BMP 파일)
- 테스트 결과 보고서
- 커버리지 분석 결과

**베이스라인 아이템:**
- 승인된 요구사항 문서
- 설계 문서
- 검증된 소스 코드
- 테스트 결과

### 6.3 변경 관리

**변경 요청 프로세스:**
1. 변경 요청서 작성 및 제출
2. 영향 분석 수행
3. 변경 검토 위원회 승인
4. 변경 구현 및 테스트
5. 변경 완료 확인 및 문서 업데이트

**변경 분류:**
- 주요 변경 (Major): 요구사항 또는 설계 변경
- 부수 변경 (Minor): 코드 최적화, 주석 수정
- 긴급 변경 (Emergency): 심각한 결함 수정

**승인 권한:**
- 주요 변경: 프로젝트 관리자 + 품질보증 관리자
- 부수 변경: 개발팀장
- 긴급 변경: 인증 담당자 + 프로젝트 관리자

## 7. 추적성 매트릭스

| 요구사항 ID | 설계 요소 | 코드 구현 | 테스트 케이스 |
|------------|-----------|-----------|---------------|
| HLR-001 | File_Validator | fread(), 헤더 검증 | TC-001, TC-002, TC-003 |
| HLR-002 | Color_Converter | rgbToGrayscale() | TC-001, TC-006 |
| HLR-003 | Output_Generator | BMP 생성 루틴 | TC-001, TC-010 |
| HLR-004 | Memory_Manager | malloc(), free() | TC-004 |
| HLR-005 | Error_Handler | 오류 처리 루틴 | TC-002~TC-005 |
| HLR-006 | MEM_Converter | MEM 파일 생성 루틴 | TC-001 |
| HLR-007 | Sobel_Filter | findEdges(), getPixel() | TC-006, TC-007, TC-008 |
| LLR-001 | BMP_Validator | 파일 시그니처 검사 | TC-002, TC-003 |
| LLR-002 | Pixel_Reader | RGB 데이터 읽기 | TC-001 |
| LLR-003 | Gray_Converter | 휘도 공식 적용 | TC-006 |
| LLR-004 | Gray_BMP_Writer | 8비트 BMP 생성 | TC-001 |
| LLR-005 | MEM_Writer | 16진수 변환 출력 | TC-001 |
| LLR-006 | Sobel_Algorithm | 3x3 컨볼루션 | TC-006, TC-007 |
| LLR-007 | Boundary_Handler | getPixel() 경계 처리 | TC-007 |
| LLR-008 | Sobel_BMP_Writer | 엣지 BMP 생성 | TC-006, TC-010 |

**추적성 매트릭스 완전성 확인:**
- 모든 상위레벨 요구사항이 설계 요소로 분해됨 ✓
- 모든 설계 요소가 코드로 구현됨 ✓  
- 모든 요구사항이 테스트 케이스로 검증됨 ✓
- 역방향 추적성 확보됨 ✓

## 8. 인증 결론

본 BMP 이미지 처리 소프트웨어(그레이스케일 변환 및 Sobel 엣지 검출)는 DO-178C DAL-D 수준의 요구사항을 충족하도록 설계 및 구현되었습니다.

**인증 요약:**
- 모든 필수 문서가 DO-178C 표준에 따라 작성되었습니다
- 요구사항부터 테스트까지 완전한 추적성이 확보되었습니다
- 계획된 검증 활동을 통해 소프트웨어의 안전성과 신뢰성이 입증될 것입니다
- Sobel 엣지 검출 기능이 추가되어 고급 이미지 처리 능력이 향상되었습니다

**준수 확인 사항:**
- ✓ 소프트웨어 요구사항 표준 (SRS) 완료
- ✓ 소프트웨어 설계 표준 (SDS) 완료  
- ✓ 소프트웨어 코드 표준 (SCS) 완료
- ✓ 소프트웨어 검증 계획 (SVP) 완료
- ✓ 소프트웨어 형상관리 계획 (SCMP) 완료
- ✓ 추적성 매트릭스 완료

**다음 단계:**
1. 계획된 테스트 케이스 실행
2. 커버리지 분석 수행  
3. 인증 심사 준비
4. 최종 인증 보고서 작성

**승인:**

개발팀장: _________________ 날짜: 2025년 9월 7일

품질보증 관리자: _________________ 날짜: 2025년 9월 7일  

인증 담당자: _________________ 날짜: 2025년 9월 7일

**문서 버전:** 1.1  
**최종 검토일:** 2025년 9월 7일  
**다음 검토 예정일:** 2025년 12월 7일
